build_environment: Ubuntu 14.04

language: python

python:
  - "2.7"

env:
  - DB_NAME=travis_ci_test DJANGO_SETTINGS_MODULE=settings PYTHONPATH=$HOME/workspace/src/github.com/geodesign/django-wms

addons:
  postgresql : "9.3"

before_install:
  - shippable_retry sudo apt-get update
  - shippable_retry sudo apt-get install python-mapscript python-gdal
  - rm $HOME/build_ve/python/2.7/lib/python2.7/no-global-site-packages.txt 
  - python -c 'import mapscript; print mapscript.msGetVersion()'

install:
  - pip install Django==1.7 psycopg2==2.5.3
  - pip install --no-deps django-raster==0.1.0

before_script:
  - psql -c 'create database "travis_ci_test";' -U postgres
  - psql -d travis_ci_test -c 'create extension postgis;' -U postgres

script: django-admin.py test wms
